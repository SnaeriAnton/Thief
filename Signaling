using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.Events;

public class Signaling : MonoBehaviour
{
    [SerializeField] private UnityEvent _playMusic;
    [SerializeField] private SpriteRenderer _rendererDoor;
    [SerializeField] private Color _reachedColor;
    [SerializeField] private AudioSource _volume;
    [SerializeField] private SpriteRenderer _spriteChest;

    private bool _signal = false;
    private int _chestStolen = 1;
    private int _minValum = 0;
    private int _maxValum = 1;
    private float increaseInVolume = 0.21f;

    private void Update()
    {
        if (_signal)
        {
            if (_spriteChest.color.a == 0)
            {
                _chestStolen = -1;
            }
            _volume.volume += Mathf.MoveTowards(_minValum, _maxValum, increaseInVolume * Time.deltaTime) * _chestStolen;
            Debug.Log(_volume.volume);
        }
        
    }

    private void OnTriggerEnter2D(Collider2D collision)
    {
        if (collision.TryGetComponent<PlayerMove>(out PlayerMove player))
        {
            _rendererDoor.color = _reachedColor;
            _playMusic.Invoke();
            _signal = true;
            
        }   
    }
}
